(self.webpackChunkprinceps_survey=self.webpackChunkprinceps_survey||[]).push([[33],{8033:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ServiceEvalSurveyModule:()=>V});var s=i(6274),n=i(6006),r=i(2032),o=i(8561),u=i(7194),a=i(4988),l=i(2741),c=i(5543),d=i(1973),g=i(6086),p=i(7662),Z=i(5196),y=i(4625),f=i(4734),v=i(1093),h=i(1579),m=i(8923);function q(e,t){if(1&e){const e=l.EpF();l.ynx(0),l.TgZ(1,"div",12),l.TgZ(2,"div",13),l._uU(3," Survey submitted successfully "),l.qZA(),l.TgZ(4,"button",14),l.NdJ("click",function(){return l.CHM(e),l.oxw().resetForm()}),l._uU(5,"update response"),l.qZA(),l.qZA(),l.BQk()}}function x(e,t){1&e&&(l.TgZ(0,"sup",15),l.TgZ(1,"b"),l._uU(2,"*"),l.qZA(),l.qZA())}function _(e,t){if(1&e&&(l.TgZ(0,"label",32),l._uU(1),l.qZA()),2&e){const e=t.$implicit;l.Q6J("nzValue",e.answer),l.xp6(1),l.Oqu(e.answer)}}function A(e,t){if(1&e&&(l.TgZ(0,"div",16),l.TgZ(1,"nz-radio-group",30),l.YNc(2,_,2,2,"label",31),l.qZA(),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(1),l.Q6J("formControlName",e.survey_question_id),l.xp6(1),l.Q6J("ngForOf",e.answer)}}const z=function(){return{minRows:4,maxRows:5}};function T(e,t){if(1&e&&(l.TgZ(0,"div"),l._UZ(1,"textarea",33),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(1),l.Q6J("formControlName",e.survey_question_id)("nzAutosize",l.DdM(2,z))}}function w(e,t){if(1&e&&(l.TgZ(0,"label",37),l._uU(1),l.qZA()),2&e){const e=t.$implicit;l.Q6J("nzValue",e.answer),l.xp6(1),l.Oqu(e.answer)}}function b(e,t){if(1&e&&(l.TgZ(0,"div"),l.TgZ(1,"div",12),l.TgZ(2,"nz-radio-group",34),l.YNc(3,w,2,2,"label",35),l.qZA(),l.qZA(),l.TgZ(4,"div",36),l.TgZ(5,"span"),l._uU(6," Not at all likely "),l.qZA(),l.TgZ(7,"span"),l._uU(8," Extremely likely "),l.qZA(),l.qZA(),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(2),l.Q6J("formControlName",e.survey_question_id),l.xp6(1),l.Q6J("ngForOf",e.answer)}}function Q(e,t){if(1&e&&(l.TgZ(0,"div",16),l.TgZ(1,"nz-radio-group",30),l.TgZ(2,"label",38),l._uU(3,"Very Poor"),l.qZA(),l.TgZ(4,"label",39),l._uU(5,"Poor"),l.qZA(),l.TgZ(6,"label",40),l._uU(7,"Bad"),l.qZA(),l.TgZ(8,"label",41),l._uU(9,"Good"),l.qZA(),l.TgZ(10,"label",42),l._uU(11,"Excellent"),l.qZA(),l.qZA(),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(1),l.Q6J("formControlName",e.survey_question_id)}}function S(e,t){if(1&e&&(l.TgZ(0,"div"),l._UZ(1,"input",43),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(1),l.Q6J("formControlName",e.survey_question_id)}}function J(e,t){1&e&&(l.ynx(0),l.TgZ(1,"div",44),l._uU(2,"This question is required"),l.qZA(),l.BQk())}function N(e,t){if(1&e&&(l.ynx(0),l.TgZ(1,"article"),l.TgZ(2,"h2",24),l._uU(3),l.YNc(4,x,3,0,"sup",25),l.qZA(),l.TgZ(5,"div",26),l.YNc(6,A,3,2,"div",27),l.TgZ(7,"div",16),l.YNc(8,T,2,3,"div",28),l.YNc(9,b,9,2,"div",28),l.YNc(10,Q,12,1,"div",27),l.YNc(11,S,2,1,"div",29),l.YNc(12,J,3,0,"ng-container",11),l.qZA(),l.qZA(),l.qZA(),l.BQk()),2&e){const e=t.$implicit,i=t.index,s=l.oxw(3);l.xp6(3),l.AsE("",i+1,".\xa0",e.question,"\xa0"),l.xp6(1),l.Q6J("ngIf","service_evaluation_001"==e.survey_question_id),l.xp6(1),l.Q6J("ngSwitch",e.answer_type),l.xp6(1),l.Q6J("ngSwitchCase","radio"),l.xp6(2),l.Q6J("ngSwitchCase","multiline"),l.xp6(1),l.Q6J("ngSwitchCase","range"),l.xp6(1),l.Q6J("ngSwitchCase","radio-secondary"),l.xp6(2),l.Q6J("ngIf",(s.formControls[e.survey_question_id].dirty||s.formControls[e.survey_question_id].touched)&&s.formControls[e.survey_question_id].errors)}}function C(e,t){1&e&&l._UZ(0,"i",45)}function U(e,t){if(1&e&&l._UZ(0,"nz-spin",46),2&e){l.oxw();const e=l.MAs(12);l.Q6J("nzIndicator",e)}}function F(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div"),l.TgZ(1,"div"),l.TgZ(2,"sup",15),l.TgZ(3,"b"),l._uU(4,"*"),l.qZA(),l.qZA(),l._uU(5,"\xa0Required "),l.qZA(),l.TgZ(6,"div",16),l.TgZ(7,"form",17),l.YNc(8,N,13,9,"ng-container",18),l.qZA(),l.qZA(),l.TgZ(9,"div",19),l.TgZ(10,"button",20),l.NdJ("click",function(){return l.CHM(e),l.oxw(2).submitSurvey()}),l.YNc(11,C,1,0,"ng-template",null,21,l.W1O),l.YNc(13,U,1,1,"nz-spin",22),l.TgZ(14,"span",23),l._uU(15,"Submit"),l.qZA(),l.qZA(),l.qZA(),l.qZA()}if(2&e){const e=l.oxw(2);l.xp6(7),l.Q6J("formGroup",e.responsesForm),l.xp6(1),l.Q6J("ngForOf",e.surveyQuestions),l.xp6(5),l.Q6J("ngIf",e.isSubmitting)}}function Y(e,t){if(1&e&&(l.ynx(0),l.YNc(1,F,16,3,"div",11),l.BQk()),2&e){const e=l.oxw();l.xp6(1),l.Q6J("ngIf",e.surveyQuestions&&e.surveyQuestions.length)}}let k=(()=>{class e{constructor(e,t,i,s,u){this.router=t,this.fb=i,this.message=s,this.service=u,this.destroy$=new n.xQ,this.isSubmitting=!1,this.showSuccess=!1,this.fetchingSurvey=!0,this.surveyQuestions=[],this.oldSurveyQuestions=[],this.topQuestions=[],this.answer_003=[],this.answer_004=[],(0,r.aj)([e.params,e.queryParams]).pipe((0,o.U)(e=>e)).subscribe(e=>{this.survey_id=e[0].survey_id,this.identifier=e[1].identifier,this.identifier_type=e[1].identifier_type,this.fetchSurveyQuestions()}),this.responsesForm=this.fb.group({})}get formControls(){return this.responsesForm.controls}ngOnInit(){}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}fetchSurveyQuestions(){this.fetchingSurvey=!0,this.surveyQuestions=[],this.surveyQuestionsData=void 0,this.service.fetchSurveyQuestions(this.survey_id).pipe().subscribe(e=>{this.showSuccess=!1,this.surveyQuestionsData=e;const t=e.questions;t.forEach(e=>{this.responsesForm.addControl(e.survey_question_id,new a.NI(null,1==e.valid?a.kI.required:null))}),this.surveyQuestions=t,this.fetchingSurvey=!1},()=>this.fetchingSurvey=!1)}selectRecommendQuestion(e){this.answer_003=[],this.answer_004=[],e&&(this.surveyQuestions=[...this.topQuestions,{survey_question_id:"service_evaluation_003",survey_id:this.survey_id,answer_type:"multiline",identifier:this.identifier,question:"Tell us why you will not recommend PCSL to a friend or work colleague? (CreditWallet)?"}])}submitSurvey(){if(this.responsesForm.valid){const e=this.responsesForm.value,t=[];Object.keys(e).forEach(i=>{t.push(new I(e[i],this.identifier,i,this.survey_id))});const i={identifier:this.identifier,identifier_type:this.identifier_type,survey_id:this.survey_id,responses:t};this.isSubmitting=!0,this.service.submitSurvey(i).pipe((0,u.R)(this.destroy$)).subscribe(e=>{this.isSubmitting=!1,this.showSuccess=!0},()=>this.isSubmitting=!1)}else Object.values(this.responsesForm.controls).forEach(e=>{e.invalid&&(e.markAsDirty(),e.updateValueAndValidity())})}resetForm(){this.responsesForm.reset(),this.showSuccess=!1}log(e,t){"service_evaluation_003"===e?this.answer_003=t:this.answer_004=t}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(c.gz),l.Y36(c.F0),l.Y36(a.qu),l.Y36(d.dD),l.Y36(g.J))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-service-eval-survey"]],decls:20,vars:5,consts:[["nz-row","","nzJustify","center"],["nz-col","","nzXs","24","nzSm","24","nzMd","20","nzLg","16"],[1,"survey-header"],[1,"survey-jumbo"],[1,"survey-title"],["role","presentation",1,"survey-text"],[1,""],[1,"survey-title","text--600"],[1,"text--300","text--regular-alt"],[1,"inner-content"],["nzSize","large",2,"min-height","200px",3,"nzSpinning"],[4,"ngIf"],[1,"text--center"],[1,"survey-success","text--center","text--large","text--600","my-2"],[1,"button","button--primary","text--capital",3,"click"],[1,"text--danger"],[1,"my-2"],[3,"formGroup"],[4,"ngFor","ngForOf"],[2,"margin","15px 0"],[1,"create-survey-btn","button","button--secondary",3,"click"],["indicatorTemplate",""],["nzSimple","",3,"nzIndicator",4,"ngIf"],[2,"display","inline-block","margin-left","8px"],[1,"text--500"],["class","text--danger",4,"ngIf"],[3,"ngSwitch"],["class","my-2",4,"ngSwitchCase"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["nzSize","large",2,"display","flex","flex-direction","column","align-items","baseline",3,"formControlName"],["nz-radio","","class","text--regular-alt my-1",3,"nzValue",4,"ngFor","ngForOf"],["nz-radio","",1,"text--regular-alt","my-1",3,"nzValue"],["nz-input","",3,"formControlName","nzAutosize"],["nzButtonStyle","solid",3,"formControlName"],["nz-radio-button","",3,"nzValue",4,"ngFor","ngForOf"],[2,"display","flex","justify-content","space-between","align-items","center","margin-top","5px"],["nz-radio-button","",3,"nzValue"],["nz-radio","","nzValue","Very Poor",1,"text--regular-alt","my-1"],["nz-radio","","nzValue","Poor",1,"text--regular-alt","my-1"],["nz-radio","","nzValue","Bad",1,"text--regular-alt","my-1"],["nz-radio","","nzValue","Good",1,"text--regular-alt","my-1"],["nz-radio","","nzValue","Excellent",1,"text--regular-alt","my-1"],["nz-input","","nzSize","large","type","text",3,"formControlName"],["id","password-help",1,"text--danger","mt-2","d-block",2,"margin-top","10px"],["nz-icon","","nzType","loading",2,"color","#fff"],["nzSimple","",3,"nzIndicator"]],template:function(e,t){1&e&&(l.TgZ(0,"section"),l.TgZ(1,"div",0),l.TgZ(2,"div",1),l.TgZ(3,"header",2),l.TgZ(4,"div",3),l.TgZ(5,"div",4),l.TgZ(6,"table",5),l.TgZ(7,"tbody"),l.TgZ(8,"tr"),l.TgZ(9,"td",6),l.TgZ(10,"h1",7),l._uU(11),l.qZA(),l.qZA(),l.qZA(),l.TgZ(12,"tr"),l.TgZ(13,"td",6),l.TgZ(14,"p",8),l._uU(15),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(16,"div",9),l.TgZ(17,"nz-spin",10),l.YNc(18,q,6,0,"ng-container",11),l.YNc(19,Y,2,1,"ng-container",11),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA()),2&e&&(l.xp6(11),l.hij(" ",null==t.surveyQuestionsData?null:t.surveyQuestionsData.title," "),l.xp6(4),l.hij(" ",null==t.surveyQuestionsData?null:t.surveyQuestionsData.subtitle," "),l.xp6(2),l.Q6J("nzSpinning",t.fetchingSurvey),l.xp6(1),l.Q6J("ngIf",t.showSuccess),l.xp6(1),l.Q6J("ngIf",!t.showSuccess))},directives:[p.SK,p.t3,Z.p0,Z.$Z,Z.Uo,y.W,s.O5,a._Y,a.JL,a.sg,s.sg,s.RF,s.n9,s.ED,f.Dg,a.JJ,a.u,f.Of,v.Zp,a.Fj,v.rh,f.Bq,h.Ls,m.w],styles:[""]}),e})();class I{constructor(e,t,i,s){this.answer=e,this.identifier=t,this.survey_question_id=i,this.survey_id=s}}var O=i(5069);let V=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[s.ez,O.m,a.u5,a.UX,c.Bz.forChild([{path:"",component:k}])]]}),e})()}}]);